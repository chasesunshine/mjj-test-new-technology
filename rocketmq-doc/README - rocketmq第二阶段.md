# rocketmq
    -P35    1. Rocket第二章内容介绍
                模拟电商网站购物场景中的【下单】和【支付】业务
            2. 技术分析
                2.1 技术选型
                    - SpringBoot
                    - Dubbo
                    - Zookeeper
                    - RocketMQ
                    - Mysql
    -P36    2.综合案例功能介绍
            1）下单
                1. 用户请求订单系统下单
                2. 订单系统通过 RPC 调用订单服务下单
                3. 订单服务调用优惠券服务，扣减优惠券
                4. 订单服务调用调用库存服务，校验并扣减库存
                5. 订单服务调用用户服务，扣减用户余额
                6. 订单服务完成确认订单
            2）支付
                1. 用户请求 支付系统
                2. 支付系统调用第三方支付平台API进行发起支付流程
                3. 用户通过第三方支付平台支付成功后，第三方支付平台回调通知支付系统
                4. 支付系统调用订单服务修改订单状态
                5. 支付系统调用积分服务添加积分
                6. 支付系统调用日志服务记录日志
    -P37    3.下单问题分析及解决方式
            1.2 问题分析
            问题1
                用户提交订单后，扣减库存成功、扣减优惠券成功、使用余额成功，但是在确认订单操作失败，需要对库存、库存、余额进行回退。
                如何保证数据的完整性？
                答： <u>使用MQ保证在下单失败后系统数据的完整性</u>  
                mjj答: 失败了就发送 mq失败的消息 为生产者，然后服务去监听，读取日志之类的进行回滚更新操作
                
    -P38    4.支付回调问题分析和解决方式         
            问题2
                用户通过第三方支付平台（支付宝、微信）支付成功后，第三方支付平台要通过回调API异步通知商家支付系统用户支付结果，支付系统根据支付结果修改订单状态、记录支付日志和给用户增加积分。
                商家支付系统如何保证在收到第三方支付平台的异步通知时，如何快速给第三方支付凭条做出回应？
                <u>通过MQ进行数据分发，提高系统处理性能</u>